---
import YouTubeIcon from './YouTubeIcon.astro';
import SpotifyIcon from './SpotifyIcon.astro';
import {
  buildAlbumSearchQuery,
  buildArtistSearchQuery,
  getYouTubeSearchUrl,
  getSpotifySearchUrl,
} from '../../lib/externalLinks';

interface Props {
  artistName: string;
  albumName?: string;
  year?: number | null;
  spotifyDirectUrl?: string | null;
}

const { artistName, albumName, year, spotifyDirectUrl } = Astro.props;

const query = albumName
  ? buildAlbumSearchQuery(artistName, albumName, year ?? null)
  : buildArtistSearchQuery(artistName);

const youtubeUrl = getYouTubeSearchUrl(query);
const spotifyUrl = spotifyDirectUrl ?? getSpotifySearchUrl(query, albumName ? "albums" : "artists");

const subjectLabel = albumName
  ? `${albumName} by ${artistName}`
  : artistName;

const spotifyAction = spotifyDirectUrl ? 'Open' : 'Search for';
---

<div class="flex items-center gap-2">
  <a
    href={youtubeUrl}
    target="_blank"
    rel="noopener noreferrer"
    aria-label={`Search for ${subjectLabel} on YouTube`}
    class="inline-flex items-center gap-1.5 rounded-md border border-surface-200 px-2.5 py-1 text-xs text-gray-400 transition-colors hover:border-red-500/50 hover:text-red-400"
  >
    <YouTubeIcon class="h-3.5 w-3.5" />
    YouTube
  </a>
  <a
    href={spotifyUrl}
    target="_blank"
    rel="noopener noreferrer"
    aria-label={`${spotifyAction} ${subjectLabel} on Spotify`}
    class="inline-flex items-center gap-1.5 rounded-md border border-surface-200 px-2.5 py-1 text-xs text-gray-400 transition-colors hover:border-green-500/50 hover:text-green-400"
  >
    <SpotifyIcon class="h-3.5 w-3.5" />
    Spotify
  </a>
</div>
